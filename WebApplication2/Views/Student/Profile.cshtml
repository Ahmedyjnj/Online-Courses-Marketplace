@model StudentViewModel

@{
    ViewData["Title"] = "My Profile";
    Layout = "_Layout";
}

<link rel="stylesheet" href="~/css/StudentProfile.css">

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-12 col-lg-10">

            <!-- ✅ الغلاف مع الصورة الشخصية -->
            <div class="cover-section mb-5">
                <div class="profile-img-wrapper">
                    <img src="@(!string.IsNullOrEmpty(Model.PhotoUrl) ? Model.PhotoUrl : Url.Content("~/Content/Images/default-user.png"))" alt="@Model.Name" />
                    <span class="profile-img-edit" data-bs-toggle="modal" data-bs-target="#editPhotoModal" title="Edit Profile Photo">
                        <i class="bi bi-camera"></i>
                    </span>
                </div>
            </div>

            <!-- ✅ بيانات الطالب -->
            <div class="profile-header">
                <div>
                    <h2>
                        @Model.Name
                        <span class="edit-icon" data-bs-toggle="modal" data-bs-target="#editNameModal" title="Edit Name"><i class="bi bi-pencil-square"></i></span>
                    </h2>
                    <div class="mb-2">
                        <span class="badge bg-success"><i class="bi bi-star-fill"></i> @(Model.Rating?.ToString("0.0") ?? "N/A")</span>
                        <span class="edit-icon" data-bs-toggle="modal" data-bs-target="#editRatingModal" title="Edit Rating"><i class="bi bi-pencil-square"></i></span>
                    </div>
                </div>
                <div class="d-flex flex-wrap gap-2">
                    <a asp-action="Edit" asp-controller="Student" asp-route-id="@Model.Id" class="btn btn-primary">
                        <i class="bi bi-pencil"></i> Edit Profile
                    </a>
                    <a asp-action="Index" asp-controller="Home" class="btn btn-secondary">
                        <i class="bi bi-house"></i> Home
                    </a>
                </div>
            </div>

            <!-- ✅ معلومات الطالب -->
            <div class="row mt-5">
                <div class="col-md-8">
                    <div class="card shadow-sm rounded-4 info-card">
                        <div class="card-body">
                            <span>
                                <i class="bi bi-envelope"></i> <strong>Email:</strong> <span class="text-muted">@Model.Email</span>
                                <span class="edit-icon" data-bs-toggle="modal" data-bs-target="#editEmailModal" title="Edit Email"><i class="bi bi-pencil-square"></i></span>
                            </span>
                            <span>
                                <i class="bi bi-phone"></i> <strong>Phone:</strong> <span class="text-muted">@Model.Phone</span>
                                <span class="edit-icon" data-bs-toggle="modal" data-bs-target="#editPhoneModal" title="Edit Phone"><i class="bi bi-pencil-square"></i></span>
                            </span>
                            <span>
                                <i class="bi bi-gender-ambiguous"></i> <strong>Gender:</strong> <span class="text-muted">@(Model.Gender ?? "Not set")</span>
                                <span class="edit-icon" data-bs-toggle="modal" data-bs-target="#editGenderModal" title="Edit Gender"><i class="bi bi-pencil-square"></i></span>
                            </span>
                            <span>
                                <i class="bi bi-calendar-date"></i> <strong>Date of Birth:</strong> <span class="text-muted">@Model.DateOfBirth?.ToString("MMMM dd, yyyy")</span>
                                <span class="edit-icon" data-bs-toggle="modal" data-bs-target="#editDobModal" title="Edit Date of Birth"><i class="bi bi-pencil-square"></i></span>
                            </span>
                            <span><i class="bi bi-calendar-check"></i> <strong>Registered:</strong> <span class="text-muted">@Model.RegistrationDate.ToString("MMMM dd, yyyy")</span></span>
                        </div>
                    </div>
                </div>

                <!-- ✅ قسم الكورسات - تم تعديله وتنظيمه -->
                <div class="col-12 mt-4">
                    <h4 class="mb-4">الدورات المسجلة</h4>
                    <div class="row g-4">
                        @if(Model.Courses != null){
                        @foreach (var course in Model.Courses)
                        {
                            <div class="col-sm-6 col-lg-4 ">
                                <div class="card h-100  shadow-sm border-0 animate__animated animate__fadeInUp rounded-4">
                                    <img src="@course.PhotoUrl" class="card-img-top" alt="@course.Title" style="height: 200px; object-fit: cover;">
                                    <div class="card-body d-flex flex-column">
                                        <h5 class="card-title text-info">@course.Title</h5>
                                        <p class="card-subtitle mb-2 text-muted">@course.Category</p>
                                        <p class="card-text flex-grow-1">@course.Description</p>
                                        <a href="@Url.Action("Details", "Courses", new { id = course.Id })" class="btn btn-outline-info mt-3">عرض المحتوى</a>
                                    </div>
                                    @if (course.Instructor != null)
                                    {
                                        <div class="card-footer d-flex align-items-center bg-light">
                                            <img src="@course.Instructor.PhotoUrl" alt="@course.Instructor.Name" class="rounded-circle me-2" style="width: 40px; height: 40px; object-fit: cover;">
                                            <span class="text-muted small">By @course.Instructor.Name</span>
                                        </div>
                                    }
                                </div>
                            </div>
                        }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
